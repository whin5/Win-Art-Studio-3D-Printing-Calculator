<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Win Art Studio: 3D Printing Calculator + Income Tracker + Invoice</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<div class="header">
  <div class="logo-preview">
    <img id="logo-img" src="" alt="Logo Preview" style="display:none;">
  </div>
  <input type="file" id="logo-upload" accept="image/*">
  <h1>Win Art Studio: 3D Printing Calculator + Income Tracker + Invoice</h1>
</div>

<div class="tabs">
  <button class="tab active" data-tab="filament">Filament</button>
  <button class="tab" data-tab="resin">Resin</button>
  <button class="tab" data-tab="history">History</button>
</div>

<div class="panel" id="panel-filament">
  <div class="form-grid">
    <label>Project Name</label>
    <input type="text" id="f-name" placeholder="Project name">
    <label>Currency</label>
    <select id="f-currency"></select>
    <label>Material Price (per kg)</label>
    <input type="number" id="f-price" value="900">
    <label>Material Used (grams)</label>
    <input type="number" id="f-used" value="100">
    <label>Print Time (hours)</label>
    <input type="number" id="f-time" value="5">
    <label>Power Draw (W)</label>
    <input type="number" id="f-power" value="120">
    <label>Electricity Rate</label>
    <input type="number" id="f-electricity" value="12">
    <label>Labor Rate</label>
    <input type="number" id="f-labor" value="200">
    <label>Machine Amortization</label>
    <input type="number" id="f-machine" value="50">
    <label>Markup %</label>
    <input type="number" id="f-markup" value="30">
    <button id="f-calc">Calculate & Save</button>
  </div>
  <div id="f-results"></div>
</div>

<div class="panel" id="panel-resin" style="display:none">
  <div class="form-grid">
    <label>Project Name</label>
    <input type="text" id="r-name" placeholder="Project name">
    <label>Currency</label>
    <select id="r-currency"></select>
    <label>Resin Price (per liter)</label>
    <input type="number" id="r-price" value="1200">
    <label>Resin Used (ml)</label>
    <input type="number" id="r-used" value="90">
    <label>Print Time (hours)</label>
    <input type="number" id="r-time" value="7">
    <label>Power Draw (W)</label>
    <input type="number" id="r-power" value="70">
    <label>Electricity Rate</label>
    <input type="number" id="r-electricity" value="12">
    <label>Labor Rate</label>
    <input type="number" id="r-labor" value="250">
    <label>Machine Amortization</label>
    <input type="number" id="r-machine" value="60">
    <label>Markup %</label>
    <input type="number" id="r-markup" value="30">
    <button id="r-calc">Calculate & Save</button>
  </div>
  <div id="r-results"></div>
</div>

<div class="panel" id="panel-history" style="display:none">
  <button id="export-summary">Export All History to Excel</button>
  <table id="history-table">
    <thead>
      <tr>
        <th>Project</th>
        <th>Type</th>
        <th>Total Cost</th>
        <th>Total Income</th>
        <th>Invoice</th>
      </tr>
    </thead>
    <tbody></tbody>
    <tfoot>
      <tr>
        <th colspan="3">Total Income</th>
        <th id="total-income">0</th>
        <th></th>
      </tr>
    </tfoot>
  </table>
</div>

<script src="script.js"></script>
</body>
</html>
