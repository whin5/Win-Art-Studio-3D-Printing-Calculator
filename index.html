<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Win Art Studio: 3D Printing Calculator & Income Tracker</title>
<link rel="stylesheet" href="style.css">
<script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
</head>
<body>
<div class="container">
  <header>
    <h1>Win Art Studio: 3D Printing Calculator & Income Tracker</h1>
    <label class="logo-upload">Upload Logo
      <input type="file" id="logoInput">
    </label>
    <img id="logoPreview" src="" alt="Company Logo" style="display:none; max-height:50px;">
  </header>

  <div class="tabs">
    <button class="tab-btn active" data-tab="resin">Resin</button>
    <button class="tab-btn" data-tab="filament">Filament</button>
    <button class="tab-btn" data-tab="history">History</button>
  </div>

  <!-- Resin Tab -->
  <div id="resin" class="tab-panel">
    <h2>Resin Project</h2>
    <div class="grid">
      <label>Project Name<input type="text" id="r-name"></label>
      <label>Currency<input type="text" id="r-currency" placeholder="PHP" value="PHP"></label>
      <label>Resin Bottle Price<input type="number" id="r-bottlePrice" value="1200"></label>
      <label>Bottle Volume (ml)<input type="number" id="r-bottleVolume" value="1000"></label>
      <label>Resin Used (ml)<input type="number" id="r-ml" value="90"></label>
      <label>Print Time (hours)<input type="number" id="r-time" value="7.5"></label>
      <label>Printer Power Draw (W)<input type="number" id="r-watts" value="70"></label>
      <label>Electricity Rate<input type="number" id="r-kwh" value="12"></label>
      <label>Labor Rate<input type="number" id="r-laborRate" value="250"></label>
      <label>Machine Amortization (per hour)<input type="number" id="r-machine" value="60"></label>
      <label>Markup %<input type="number" id="r-markup" value="30"></label>
      <button id="r-calc" class="btn">Calculate & Add to History</button>
    </div>
    <div id="r-results" class="results"></div>
    <button id="r-invoice" class="btn">Export Last Resin Invoice</button>
  </div>

  <!-- Filament Tab -->
  <div id="filament" class="tab-panel">
    <h2>Filament Project</h2>
    <div class="grid">
      <label>Project Name<input type="text" id="f-name"></label>
      <label>Currency<input type="text" id="f-currency" placeholder="PHP" value="PHP"></label>
      <label>Filament Price<input type="number" id="f-price" value="1000"></label>
      <label>Filament Used (g)<input type="number" id="f-used" value="100"></label>
      <label>Print Time (hours)<input type="number" id="f-time" value="7.5"></label>
      <label>Printer Power Draw (W)<input type="number" id="f-watts" value="70"></label>
      <label>Electricity Rate<input type="number" id="f-kwh" value="12"></label>
      <label>Labor Rate<input type="number" id="f-laborRate" value="250"></label>
      <label>Machine Amortization (per hour)<input type="number" id="f-machine" value="60"></label>
      <label>Markup %<input type="number" id="f-markup" value="30"></label>
      <button id="f-calc" class="btn">Calculate & Add to History</button>
    </div>
    <div id="f-results" class="results"></div>
    <button id="f-invoice" class="btn">Export Last Filament Invoice</button>
  </div>

  <!-- History Tab -->
  <div id="history" class="tab-panel">
    <h2>Project History</h2>
    <table id="historyTable">
      <thead>
        <tr>
          <th>Project Name</th>
          <th>Type</th>
          <th>Total Cost</th>
          <th>Total Income</th>
          <th>Invoice</th>
        </tr>
      </thead>
      <tbody></tbody>
      <tfoot>
        <tr>
          <td colspan="3">Total Income:</td>
          <td id="totalIncome">0</td>
          <td></td>
        </tr>
      </tfoot>
    </table>
    <button id="exportHistory" class="btn">Export Full History</button>
    <button id="clearHistory" class="btn">Clear History</button>
  </div>
</div>

<script src="script.js"></script>
</body>
</html>
